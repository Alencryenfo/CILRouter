# ğŸ“ CIL Router é¡¹ç›®ç»“æ„

## ğŸ—ï¸ é¡¹ç›®ç›®å½•ç»“æ„

```
CILRouter/
â”œâ”€â”€ ğŸ“„ æ ¸å¿ƒæ–‡æ¡£
â”‚   â”œâ”€â”€ README.md                    # é¡¹ç›®ä¸»è¦è¯´æ˜æ–‡æ¡£
â”‚   â”œâ”€â”€ README_EN.md                 # è‹±æ–‡è¯´æ˜æ–‡æ¡£  
â”‚   â”œâ”€â”€ CLAUDE.md                    # Claude Code é¡¹ç›®é…ç½®
â”‚   â”œâ”€â”€ LICENSE                      # å¼€æºè®¸å¯è¯
â”‚   â””â”€â”€ PROJECT_STRUCTURE.md         # é¡¹ç›®ç»“æ„è¯´æ˜ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”‚
â”œâ”€â”€ ğŸš€ åº”ç”¨ç¨‹åº
â”‚   â””â”€â”€ app/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ main.py                  # ä¸»åº”ç”¨å…¥å£
â”‚       â”œâ”€â”€ middleware/              # ä¸­é—´ä»¶
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â””â”€â”€ rate_limiter.py      # é™æµä¸­é—´ä»¶
â”‚       â”œâ”€â”€ utils/                   # å·¥å…·æ¨¡å—
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â””â”€â”€ logger.py            # æ—¥å¿—å·¥å…·
â”‚       â””â”€â”€ data/                    # åº”ç”¨æ•°æ®
â”‚           â”œâ”€â”€ blocked_ips.json     # é˜»æ­¢IPåˆ—è¡¨
â”‚           â””â”€â”€ log/                 # æ—¥å¿—ç›®å½•
â”‚               â””â”€â”€ cilrouter.log    # åº”ç”¨æ—¥å¿—
â”‚
â”œâ”€â”€ âš™ï¸ é…ç½®æ¨¡å—
â”‚   â””â”€â”€ config/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â””â”€â”€ config.py                # é…ç½®ç®¡ç†
â”‚
â”œâ”€â”€ ğŸ§ª æµ‹è¯•å¥—ä»¶
â”‚   â””â”€â”€ test_suites/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ unit/                    # å•å…ƒæµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ conftest.py          # pytest é…ç½®
â”‚       â”‚   â”œâ”€â”€ test_main.py         # åŸºç¡€åŠŸèƒ½æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_comprehensive_functionality.py  # å…¨é¢åŠŸèƒ½æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_streaming_functionality.py      # æµå¼å¤„ç†æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_rate_limit_comprehensive.py     # é™æµåŠŸèƒ½æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_streaming_error_direct.py       # æµå¼é”™è¯¯æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_streaming_error_fix_validation.py # ä¿®å¤éªŒè¯æµ‹è¯•
â”‚       â”‚   â””â”€â”€ test_streaming_error_issue.py        # é”™è¯¯é—®é¢˜æµ‹è¯•
â”‚       â”œâ”€â”€ integration/             # é›†æˆæµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ test_final_integration.py      # æœ€ç»ˆé›†æˆæµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_integration_final.py      # é›†æˆæµ‹è¯•ï¼ˆå¤‡ç”¨ï¼‰
â”‚       â”‚   â””â”€â”€ test_error_handling_failover.py # é”™è¯¯å¤„ç†é›†æˆæµ‹è¯•
â”‚       â”œâ”€â”€ stress/                  # å‹åŠ›æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â”œâ”€â”€ test_extreme_stress.py         # æç«¯å‹åŠ›æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ test_rate_limit_extreme.py     # é™æµæé™æµ‹è¯•
â”‚       â”‚   â””â”€â”€ test_advanced_robustness.py    # é«˜çº§å¥å£®æ€§æµ‹è¯•
â”‚       â”œâ”€â”€ security/               # å®‰å…¨æµ‹è¯•
â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚       â”‚   â””â”€â”€ test_logger_robustness.py      # æ—¥å¿—å®‰å…¨æµ‹è¯•
â”‚       â”œâ”€â”€ performance/            # æ€§èƒ½æµ‹è¯•
â”‚       â”‚   â””â”€â”€ __init__.py
â”‚       â””â”€â”€ reports/                # æµ‹è¯•æŠ¥å‘Š
â”‚           â”œâ”€â”€ __init__.py
â”‚           â””â”€â”€ comprehensive_test_report.py   # ç»¼åˆæµ‹è¯•æŠ¥å‘Šç”Ÿæˆå™¨
â”‚
â”œâ”€â”€ ğŸ“š æ–‡æ¡£ç›®å½•
â”‚   â””â”€â”€ docs/
â”‚       â”œâ”€â”€ reports/                 # æµ‹è¯•æŠ¥å‘Š
â”‚       â”‚   â”œâ”€â”€ comprehensive_test_report.md     # ç»¼åˆæµ‹è¯•æŠ¥å‘Š
â”‚       â”‚   â”œâ”€â”€ final_test_summary.md           # æœ€ç»ˆæµ‹è¯•æ€»ç»“
â”‚       â”‚   â””â”€â”€ streaming_error_fix_report.md   # æµå¼é”™è¯¯ä¿®å¤æŠ¥å‘Š
â”‚       â”œâ”€â”€ api/                     # API æ–‡æ¡£ï¼ˆé¢„ç•™ï¼‰
â”‚       â””â”€â”€ deployment/              # éƒ¨ç½²æ–‡æ¡£ï¼ˆé¢„ç•™ï¼‰
â”‚
â”œâ”€â”€ ğŸ³ éƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ Dockerfile                   # Docker é•œåƒæ„å»º
â”‚   â”œâ”€â”€ docker-compose.yml          # Docker Compose é…ç½®
â”‚   â””â”€â”€ requirements.txt             # Python ä¾èµ–
â”‚
â””â”€â”€ ğŸ“‹ å…¶ä»–æ–‡ä»¶
    â””â”€â”€ cilrouter.log               # æ ¹ç›®å½•æ—¥å¿—æ–‡ä»¶
```

## ğŸ“‚ ç›®å½•è¯¦ç»†è¯´æ˜

### ğŸš€ åº”ç”¨ç¨‹åº (`app/`)
åŒ…å«CIL Routerçš„æ ¸å¿ƒåº”ç”¨ä»£ç ï¼š

- **`main.py`**: ä¸»åº”ç”¨æ–‡ä»¶ï¼ŒåŒ…å«FastAPIåº”ç”¨å’Œè·¯ç”±å¤„ç†
- **`middleware/`**: ä¸­é—´ä»¶æ¨¡å—
  - `rate_limiter.py`: åŸºäºä»¤ç‰Œæ¡¶ç®—æ³•çš„é™æµä¸­é—´ä»¶
- **`utils/`**: é€šç”¨å·¥å…·æ¨¡å—
  - `logger.py`: ç»“æ„åŒ–æ—¥å¿—è®°å½•å·¥å…·
- **`data/`**: åº”ç”¨è¿è¡Œæ—¶æ•°æ®
  - `blocked_ips.json`: IPé˜»æ­¢åˆ—è¡¨
  - `log/`: æ—¥å¿—æ–‡ä»¶å­˜å‚¨ç›®å½•

### âš™ï¸ é…ç½®æ¨¡å— (`config/`)
- **`config.py`**: ç»Ÿä¸€é…ç½®ç®¡ç†ï¼Œæ”¯æŒç¯å¢ƒå˜é‡å’Œé»˜è®¤é…ç½®

### ğŸ§ª æµ‹è¯•å¥—ä»¶ (`test_suites/`)
æŒ‰åŠŸèƒ½å’Œç±»å‹åˆ†ç±»çš„æµ‹è¯•ä»£ç ï¼š

#### å•å…ƒæµ‹è¯• (`unit/`)
- åŸºç¡€åŠŸèƒ½æµ‹è¯•
- ç»„ä»¶çº§æµ‹è¯•
- APIç«¯ç‚¹æµ‹è¯•
- æµå¼å¤„ç†æµ‹è¯•
- é™æµåŠŸèƒ½æµ‹è¯•

#### é›†æˆæµ‹è¯• (`integration/`)
- ç«¯åˆ°ç«¯æµ‹è¯•
- å¤šæ¨¡å—åä½œæµ‹è¯•
- ç¯å¢ƒé…ç½®æµ‹è¯•
- é”™è¯¯å¤„ç†é›†æˆæµ‹è¯•

#### å‹åŠ›æµ‹è¯• (`stress/`)
- é«˜å¹¶å‘æµ‹è¯•
- èµ„æºè€—å°½æµ‹è¯•
- æç«¯æ¡ä»¶æµ‹è¯•
- æ€§èƒ½åŸºå‡†æµ‹è¯•

#### å®‰å…¨æµ‹è¯• (`security/`)
- å®‰å…¨æ¼æ´æµ‹è¯•
- æ”»å‡»é˜²æŠ¤æµ‹è¯•
- è¾“å…¥éªŒè¯æµ‹è¯•
- æƒé™æ§åˆ¶æµ‹è¯•

#### æ€§èƒ½æµ‹è¯• (`performance/`)
- å“åº”æ—¶é—´æµ‹è¯•
- ååé‡æµ‹è¯•
- èµ„æºä½¿ç”¨æµ‹è¯•
- æ‰©å±•æ€§æµ‹è¯•

#### æµ‹è¯•æŠ¥å‘Š (`reports/`)
- è‡ªåŠ¨åŒ–æµ‹è¯•æŠ¥å‘Šç”Ÿæˆå™¨
- æµ‹è¯•ç»“æœæ±‡æ€»å·¥å…·

### ğŸ“š æ–‡æ¡£ç›®å½• (`docs/`)
é¡¹ç›®ç›¸å…³æ–‡æ¡£ï¼š

- **`reports/`**: æµ‹è¯•æŠ¥å‘Šå’Œåˆ†ææ–‡æ¡£
- **`api/`**: APIæ–‡æ¡£ï¼ˆé¢„ç•™ï¼Œå¯æ·»åŠ OpenAPIè§„èŒƒç­‰ï¼‰
- **`deployment/`**: éƒ¨ç½²æŒ‡å—å’Œè¿ç»´æ–‡æ¡£ï¼ˆé¢„ç•™ï¼‰

## ğŸ¯ ç›®å½•è®¾è®¡åŸåˆ™

### 1. **åˆ†ç¦»å…³æ³¨ç‚¹**
- åº”ç”¨ä»£ç ã€é…ç½®ã€æµ‹è¯•ã€æ–‡æ¡£å®Œå…¨åˆ†ç¦»
- æµ‹è¯•æŒ‰ç±»å‹å’ŒåŠŸèƒ½è¿›ä¸€æ­¥åˆ†ç±»

### 2. **å¯æ‰©å±•æ€§**
- é¢„ç•™äº†APIæ–‡æ¡£ã€éƒ¨ç½²æ–‡æ¡£ç­‰ç›®å½•
- æ€§èƒ½æµ‹è¯•ç›®å½•ä¸ºæœªæ¥æ‰©å±•åšå‡†å¤‡

### 3. **å¼€å‘å‹å¥½**
- æ¸…æ™°çš„ç›®å½•ç»“æ„ä¾¿äºæ–°å¼€å‘è€…ç†è§£
- æµ‹è¯•æ–‡ä»¶æŒ‰åŠŸèƒ½åˆ†ç±»ï¼Œæ˜“äºç»´æŠ¤

### 4. **CI/CDå‹å¥½**
- æµ‹è¯•æŒ‰ç±»å‹åˆ†ç»„ï¼Œå¯ä»¥åˆ†é˜¶æ®µè¿è¡Œ
- æŠ¥å‘Šç”Ÿæˆå™¨å¯ä»¥é›†æˆåˆ°è‡ªåŠ¨åŒ–æµç¨‹

## ğŸ”§ ä½¿ç”¨æŒ‡å—

### è¿è¡Œä¸åŒç±»å‹çš„æµ‹è¯•

```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
python -m pytest test_suites/unit/ -v

# è¿è¡Œé›†æˆæµ‹è¯•
python -m pytest test_suites/integration/ -v

# è¿è¡Œå‹åŠ›æµ‹è¯•
python -m pytest test_suites/stress/ -v

# è¿è¡Œå®‰å…¨æµ‹è¯•
python -m pytest test_suites/security/ -v

# è¿è¡Œæ‰€æœ‰æµ‹è¯•
python -m pytest test_suites/ -v

# ç”Ÿæˆç»¼åˆæµ‹è¯•æŠ¥å‘Š
python test_suites/reports/comprehensive_test_report.py
```

### æ·»åŠ æ–°æµ‹è¯•

1. **å•å…ƒæµ‹è¯•**: æ·»åŠ åˆ° `test_suites/unit/`
2. **é›†æˆæµ‹è¯•**: æ·»åŠ åˆ° `test_suites/integration/`
3. **æ€§èƒ½æµ‹è¯•**: æ·»åŠ åˆ° `test_suites/performance/`
4. **å®‰å…¨æµ‹è¯•**: æ·»åŠ åˆ° `test_suites/security/`

### æ–‡æ¡£ç®¡ç†

1. **æµ‹è¯•æŠ¥å‘Š**: ä¿å­˜åˆ° `docs/reports/`
2. **APIæ–‡æ¡£**: ä¿å­˜åˆ° `docs/api/`
3. **éƒ¨ç½²æ–‡æ¡£**: ä¿å­˜åˆ° `docs/deployment/`

## ğŸ“‹ æ–‡ä»¶å‘½åè§„èŒƒ

- **æµ‹è¯•æ–‡ä»¶**: `test_*.py`
- **é…ç½®æ–‡ä»¶**: `*_config.py` æˆ– `config.py`
- **å·¥å…·æ–‡ä»¶**: `*_utils.py` æˆ–æ”¾åœ¨ `utils/` ç›®å½•
- **æ–‡æ¡£æ–‡ä»¶**: `*.md`
- **æŠ¥å‘Šæ–‡ä»¶**: `*_report.*`

---

**ç»´æŠ¤è€…**: CIL Router å¼€å‘å›¢é˜Ÿ  
**æœ€åæ›´æ–°**: 2025å¹´8æœˆ12æ—¥  
**ç‰ˆæœ¬**: 1.0.1